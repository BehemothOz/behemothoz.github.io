<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>JSONP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="Baner.html">Baner</a></p>

<ol>
<li><a href="Baner--Время_и_з-п.html">Время и з/п</a></li>
</ol>
<p><a href="JavaScript.html">JavaScript</a></p>

<ol>
<li><a href="JavaScript--JS_Шаблоны_(Объекты).html">JS Шаблоны (Объекты)</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Шаблоны_создания_объектов).html">JS Шаблоны (Шаблоны создания объектов)</a></li>
<ol>
<li><a href="JavaScript--JS_Шаблоны_(Шаблоны_создания_объектов)--Пространство_имен.html">Пространство имен</a></li>
</ol>
<li><a href="JavaScript--JS_Шаблоны_(Обертки).html">JS Шаблоны (Обертки)</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Массивы).html">JS Шаблоны (Массивы)</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Определения).html">JS Шаблоны (Функции / Определения)</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа).html">JS Шаблоны (Функции / Работа)</a></li>
<ol>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа)--Функции_обратного_вызова.html">Функции обратного вызова</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа)--Возврат_функции.html">Возврат функции</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа)--Самоопределяемые_функции.html">Самоопределяемые функции</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа)--Немедленно_вызываемые_функции.html">Немедленно вызываемые функции</a></li>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Работа)--Значения,_возвращаемые_немедленно_вызываемыми_функциями.html">Значения, возвращаемые немедленно вызываемыми функциями</a></li>
</ol>
<li><a href="JavaScript--JS_Шаблоны_(Функции_-_Примеры).html">JS Шаблоны (Функции / Примеры)</a></li>
<li><a href="JavaScript--JS_Шаблоны_(JSON).html">JS Шаблоны (JSON)</a></li>
<li><a href="JavaScript--Работа_с_DOM_деревом.html">Работа с DOM деревом</a></li>
<ol>
<li><a href="JavaScript--Работа_с_DOM_деревом--Перемещение_DOM_элементов.html">Перемещение DOM элементов</a></li>
<li><a href="JavaScript--Работа_с_DOM_деревом--Создание_DOM_элементов.html">Создание DOM элементов</a></li>
</ol>
<li><a href="JavaScript--Шаблонизация.html">Шаблонизация</a></li>
<li><a href="JavaScript--Конструкторы_и_прототипы.html">Конструкторы и прототипы</a></li>
<li><a href="JavaScript--AJAX.html">AJAX</a></li>
<ol>
<li><a href="JavaScript--AJAX--JSONP.html">JSONP</a></li>
</ol>
<li><a href="JavaScript--!Мысли.html">!Мысли</a></li>
<li><a href="JavaScript--style_js.html">style js</a></li>
<li><a href="JavaScript--console.time.html">console.time</a></li>
<li><a href="JavaScript--documentFragment.html">documentFragment</a></li>
<li><a href="JavaScript--WebWorker.html">WebWorker</a></li>
<li><a href="JavaScript--Вопросы.html">Вопросы</a></li>
<li><a href="JavaScript--Первый_xhr.html">Первый xhr</a></li>
</ol>
<p><a href="JavaScript2015(ES6).html">JavaScript2015(ES6)</a></p>

<ol>
<li><a href="JavaScript2015(ES6)--let_-_const.html">let / const</a></li>
<li><a href="JavaScript2015(ES6)--template_literals.html">template literals</a></li>
<li><a href="JavaScript2015(ES6)--Функции.html">Функции</a></li>
</ol>
<p><a href="Верстка.html">Верстка</a></p>

<ol>
<li><a href="Верстка--Приемы.html">Приемы</a></li>
<ol>
<li><a href="Верстка--Приемы--Многоточие_для_текста.html">Многоточие для текста</a></li>
<li><a href="Верстка--Приемы--Скрыть_текст.html">Скрыть текст</a></li>
</ol>
</ol>
<p><a href="Полезные_ссылки.html">Полезные ссылки</a></p>

<ol>
<li><a href="Полезные_ссылки--Верстка.html">Верстка</a></li>
<ol>
<li><a href="Полезные_ссылки--Верстка--Online_инструменты.html">Online инструменты</a></li>
</ol>
<li><a href="Полезные_ссылки--JavaScript.html">JavaScript</a></li>
</ol>
<p><a href="Словарь.html">Словарь</a></p>

<p><a href="Общее.html">Общее</a></p>

<p><a href="Как_я_ставил_pma.html">Как я ставил pma</a></p>

<p><a href="php.html">php</a></p>

<ol>
<li><a href="php--Вопросы.html">Вопросы</a></li>
<li><a href="php--debug.html">debug</a></li>
<li><a href="php--Форма.html">Форма</a></li>
<li><a href="php--Основы.html">Основы</a></li>
<ol>
<li><a href="php--Основы--Переменные.html">Переменные</a></li>
<ol>
<li><a href="php--Основы--Переменные--Локальные.html">Локальные</a></li>
<li><a href="php--Основы--Переменные--Глобальные.html">Глобальные</a></li>
<li><a href="php--Основы--Переменные--Статические.html">Статические</a></li>
<li><a href="php--Основы--Переменные--Суперглобальные.html">Суперглобальные</a></li>
<ol>
<li><a href="php--Основы--Переменные--Суперглобальные--$_SESSION_and_$_COOKIE.html">$_SESSION and $_COOKIE</a></li>
</ol>
</ol>
<li><a href="php--Основы--Функции.html">Функции</a></li>
<li><a href="php--Основы--Объекты.html">Объекты</a></li>
</ol>
<li><a href="php--MYSQL.html">MYSQL</a></li>
<ol>
<li><a href="php--MYSQL--Начало_работы.html">Начало работы</a></li>
<li><a href="php--MYSQL--Типы_данных.html">Типы данных</a></li>
<li><a href="php--MYSQL--Добавление_данных.html">Добавление данных</a></li>
<li><a href="php--MYSQL--Работа_с_таблицей.html">Работа с таблицей</a></li>
<li><a href="php--MYSQL--Индекс.html">Индекс</a></li>
<li><a href="php--MYSQL--Запросы_к_Базе_Данных.html">Запросы к Базе Данных</a></li>
</ol>
<li><a href="php--PHP_и_MySQL.html">PHP и MySQL</a></li>
</ol></div>
<div class="page"><h1><b><u>JSONP</u></b></h1><strong>JSONP </strong>—<br />способ загрузки данных, основанный на подключении из кода тега script.<br /><br />(<strong>wiki</strong><br /><span style="color:#222222;background-color:#ffffff;">«JSON with padding» (JSON с набивкой) — это дополнение к базовому формату JSON . <br />Он предоставляет способ запросить данные с сервера, находящегося в другом домене — операцию, <br />запрещённую в типичных веб-браузерах из-за политики ограничения домена.</span>)<br /><br />Если создать тег <strong>&lt;script src&gt;</strong>, то при добавлении в документ запустится процесс загрузки src. <br />В ответ сервер может прислать скрипт, содержащий нужные данные.<br />Таким образом можно запрашивать данные с любого сервера, в любом браузере, <br />без каких-либо разрешений и дополнительных проверок.<br /><br /><strong>По сути, это подключение скрипта, в котором уже находятся нужные данные</strong>.<br /><span style="text-decoration:underline;">Эти подключаемые скрипты генерируются сервером!</span><br /><br />В этом скрипте, который приходит с сервера, находится вызов функции (о имени которой<br />было соглашение), параметрами этой функции служат как раз данные, которые нам и нужны.<br /><br /><br /><strong>Пример серверной части:</strong> (например, это <strong>data.js</strong>)<br />ps имя функции уже известно! (договорились с сервером)<br /><div class="codebox"><div class="codebox">__jsonpCallbak([<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span style="color:#000000;font-weight:700">name</span>:&nbsp;<span style="color:#edd400;font-weight:400">'name1'</span>},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span style="color:#000000;font-weight:700">name</span>:&nbsp;<span style="color:#edd400;font-weight:400">'name1'</span>},&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;]);</div></div><br /><br /><br /><strong>Создание функции - это ответсвенность ПРИНИМАЮЩЕЙ стороны</strong><br />Например:<br /><div class="codebox"><div class="codebox"><span style="color:#000000;font-weight:700">var</span>&nbsp;loadData;<br /><br /><span style="color:#000000;font-weight:700">function</span>&nbsp;__jsonpCallbak(data)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;loadData&nbsp;=&nbsp;data;<br />}</div></div><br /><br /><br /><strong>Как запросить данные:</strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#000000;font-weight:700">var</span>&nbsp;elem&nbsp;=&nbsp;document.createElement(<span style="color:#edd400;font-weight:400">'script'</span>);<br />elem.src&nbsp;=&nbsp;<span style="color:#edd400;font-weight:400">'data.js'</span>;&nbsp;<span style="color:#888a85;font-weight:400">//&nbsp;сгенерированный&nbsp;сервером&nbsp;скрипт</span><br />document.body.appendChild(elem);&nbsp;<span style="color:#888a85;font-weight:400">//&nbsp;lобавляем&nbsp;в&nbsp;dom</span></div></div><br /><br />*********************************************************************************<br /><br />Так как название скрипта (по идее?) неизвестно, указывываем место, где лежит скрипт.<br />+ через парметр можно передать название функции <br /><br /><div class="codebox"><div class="codebox"><span style="color:#888a85;font-weight:400">//&nbsp;Запрос</span><br /><span style="color:#000000;font-weight:700">function</span>&nbsp;addScript(src)&nbsp;{<br />&nbsp;&nbsp;<span style="color:#000000;font-weight:700">var</span>&nbsp;elem&nbsp;=&nbsp;document.createElement(<span style="color:#edd400;font-weight:400">"script"</span>);<br />&nbsp;&nbsp;elem.src&nbsp;=&nbsp;src;<br />&nbsp;&nbsp;document.head.appendChild(elem);<br />}<br /><br />Вместе&nbsp;с&nbsp;запросом&nbsp;клиент&nbsp;в&nbsp;специальном,&nbsp;заранее&nbsp;оговорённом,&nbsp;параметре&nbsp;передаёт&nbsp;название&nbsp;функции.<br /><br />Обычно&nbsp;такой&nbsp;параметр&nbsp;называется&nbsp;callback.&nbsp;Например&nbsp;:<br />addScript(<span style="color:#edd400;font-weight:400">'user?id=123&amp;callback=onUserData'</span>);<br /><br />Сервер&nbsp;кодирует&nbsp;данные&nbsp;в&nbsp;JSON&nbsp;и&nbsp;оборачивает&nbsp;их&nbsp;в&nbsp;вызов&nbsp;функции,&nbsp;название&nbsp;которой&nbsp;получает&nbsp;из&nbsp;параметра&nbsp;callback:<br /><br /><span style="color:#888a85;font-weight:400">//&nbsp;ответ&nbsp;сервера</span><br />onUserData({<br />&nbsp;&nbsp;<span style="color:#000000;font-weight:700">name</span>:&nbsp;<span style="color:#edd400;font-weight:400">"Вася"</span>,<br />&nbsp;&nbsp;age:&nbsp;<span style="color:#edd400;font-weight:400">25</span><br />});</div></div></div></div>
</body></html>